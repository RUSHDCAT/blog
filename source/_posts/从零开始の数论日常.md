---
title: 从零开始の数论日常
date: 2018-09-26 01:10:20
tags:
---

### 一、从苟狗讲起 

​	一周前，不学无术的我只会埃式筛法，南京网络赛J题被卡常之后洗心革面，学了一发线性筛，感觉很神妙。埃式筛法中，我们用每个质数去筛其倍数，这样每个数将被它的每个质因子分别标记一次，据说复杂度 $O(nlogn)$，接近线性，但是在$n>10^7$的情况下很容易被卡常。线性筛的巧妙之处在于每个数只会被其最小的质因子标记，从而将复杂度降低到$O(n)$。得益于下面代码优雅的实现，我们常用它来在素筛的同时预处理出所需的积性函数值。

```cpp
void init() {
	for(int i=2;i<N;i++) {
		if(!vis[i]) {
			pri.push_back(i);
			f[i]=?;
		}
		for(int j=0;j<pri.size() && (LL)pri[j]*i<N;j++) {
			int x=pri[j]*i;
			vis[x]=1;
			if(i%pri[j]==0) {
				f[x]=?;
				break;
			}
			f[x]=?;
		}
	}
}
```



### 二、低阶前置技能——狄利克雷卷积

​	哇，为什么要先讲这个东西呢？因为素筛之后最基本的技能就是莫比乌斯反演，从我四年前第一次想学莫比乌斯反演，直到这两天学杜教筛看到狄利克雷卷积，每次我信誓旦旦地翻开证明，都会以被那个晦涩难懂的反演公式吓跑而结尾。这两天我终于茅塞顿开，原来莫比乌斯反演就是一个狄利克雷卷积啊！狄利克雷卷积是一个数论卷积，它与多项式乘法那里的卷积形式稍有不同。请记住下面这个公式，它将在之后我们剥鸡蛋壳时成为一个强有力的武器。
$$
(g*f)(n)=\sum_{d|n} g(\frac{n}{d})*f(d)
$$




